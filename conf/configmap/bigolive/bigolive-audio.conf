module_conf: [
  {
    name: "KafkaConsumerModule"
    conf: {
      work_thread_num: 1
      enabled: true
      kafka_consumer: {
        brokers: "kafka-live-conn1.bigdata-out.bigo.inner:9092,kafka-live-conn2.bigdata-out.bigo.inner:9092,kafka-live-conn3.bigdata-out.bigo.inner:9092"
        groupid: ["live_ml_audio_audit"]
        topic: ["live-ml-audio_audit"]
      }
    }
  },
  {
    name: "DownloaderModule"
    conf: {
      work_thread_num: 128
      enabled: true
      downloader: {
        timeout_ms: 30000
        max_retry: 2
        lb: "la"
        enable_image: false
        enable_video: false
        enable_voice: true
      }
    }
  },
  {
    name: "HelloAudioCodecModule"
    conf: {
      enabled: true
      work_thread_num: 18
      hello_audio_codec: {
        out_sample_rate: 16000
        enable_wav: true
        enable_aac: false
      }
    }
  },
  {
    name: "DurationFilterModule"
    conf: {
      enabled: true
      work_thread_num: 2
      queue_size: 256
      duration_filter: {
        min_second: 4
      }
    }
  }, 
  {
    name: "DispatcherModule"
    conf: {
      work_thread_num: 64
      enabled: true
      dispatcher: {
        batch_size: 16
        submodule_conf : [
          {
            name: "AudioCoreSubModule"
            conf: {
              rpc: {
                # url: "http://audio-core.bigolive/api/audio-core"
                url: "http://audio-moan-abuse.bigolive/api/audio-moan-abuse"
                lb: "la"
                max_retry: 2
                timeout_ms: 3000
              }
              enable_model: ["moan", "abuse"]
              thresholds:[
                {
                  model: "moan"
                  country: ["PK"]
                  threshold: 0.4
                },
                {
                  model: "moan"
                  country: ["BD"]
                  threshold: 0.3
                },
                {
                  model: "moan"
                  country: ["IN"]
                  threshold: 0.5
                },
                {
                  model: "moan"
                  country: ["US"]
                  threshold: 0.45
                },
                {
                  model: "moan"
                  country: ["SA","AE","KW","IQ","QA","BH","YE","OM","JO","SY","LB","EG","LY","TN","DZ","MA","SD","MR","SO","DJ","KM","PS","IR","IL","TR"]
                  threshold: 0.45
                },
                {
                  model: "abuse"
                  country: ["default"]
                  threshold: 0.985
                }
              ]
            }
          },
          {
            name: "LidArabicSubModule"
            conf: {
              rpc: {
                url: "http://arabic-lid.bigolive/api/arabic-lid"
                lb: "la"
                max_retry: 2
                timeout_ms: 3000
              }
              thresholds:[
                {
                  model: "lid_arabic"
                  country: ["default"]
                  threshold: 1.20
                },
                {
                  model: "lid_arabic"
                  country: ["SA", "BH", "OM", "AE", "KW", "QA", "IQ", "JO", "LB", "SY", "YE", "EG"]
                  threshold: 0.09
                }
              ]
            }
          }
        ]
      }
    }
  },
  {
    name: "DispatcherModule"
    conf: {
      instance_name: "AsrDispathcerModule"
      work_thread_num: 64 
      enabled: true
      dispatcher: {
        batch_size: 1
        submodule_conf : [
          {
            name: "GulfAsrSubModule"
            conf: {
              rpc: {
                url: "http://asr-arabic.bigolive:80/api/asr-arabic"
                lb: "la"
                max_retry: 2
                timeout_ms: 5000
              }
              asr: {
                keyword: {
                  rpc: {
                    url: "http://bigolive-word-audit.nlp/api/bigolive-word-audit"
                    timeout_ms: 2000
                    max_retry: 3
                    lb: "la"
                  }
                  appid: "60"
                  businessid: 14
                  text_type: 92
                }
              }
            }
          }
        ]
      }
    }
  },
  {
    name: "FastDfsUploadModule"
    conf: {
      enabled: true
      work_thread_num: 12
      fast_dfs_upload: {
        timeout_ms: 3000
        lb: "la"
        file_expire_interval: 0 # Never expired
      }
    }
  },
  {
    name: "ReviewModule"
    conf: {
      enabled: true
      work_thread_num: 128
      review: {
        timeout_ms: 2000
        lb: "la"
        max_retry: 3
      }
    }
  },
  {
    name: "UploadHiveModule"
    conf: {
      enabled: true
      work_thread_num: 128
      upload_hive: {
        timeout_ms: 1500
        lb: "la"
        max_retry: 1
        url: "http://support_json.like.video/json?uri=123213424&aid=60"

      }
    }
  },
  {
    name: "EndModule"
    conf: {
      enabled: true
      work_thread_num: 2
    }
  }
]
